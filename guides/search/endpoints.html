

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Query Syntax &mdash; PDS APIs B15.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../_static/theme_overrides.css?v=a961033d" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=cf3848bd"></script>
      <script src="../../_static/doctools.js?v=9a2dae69"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Responses" href="responses.html" />
    <link rel="prev" title="Quickstart" href="quickstart.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            PDS APIs
              <img src="../../_static/PDS_Planets.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../overview.html">Overview</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../search.html">Search API User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Query Syntax</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#endpoints">Endpoints</a></li>
<li class="toctree-l3"><a class="reference internal" href="#search-products">Search Products</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#request-examples">Request Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#request-template">Request Template</a></li>
<li class="toctree-l4"><a class="reference internal" href="#query-detailed-syntax">Query Detailed Syntax</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#resolve-a-product-identifier">Resolve A Product Identifier</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#default-resolution">Default Resolution</a></li>
<li class="toctree-l4"><a class="reference internal" href="#search-for-latest-vs-all-versions">Search for Latest vs. All Versions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#crawl-a-data-set-hierarchy">Crawl a Data Set Hierarchy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#get-the-collections-of-a-bundle">Get the Collections of a Bundle</a></li>
<li class="toctree-l4"><a class="reference internal" href="#get-the-observational-products-of-a-bundle">Get the Observational Products of a Bundle</a></li>
<li class="toctree-l4"><a class="reference internal" href="#get-the-collection-or-bundles-of-an-observational-product">Get the Collection or Bundles of an Observational Product</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#use-pagination-to-get-all-products-matching-a-request">Use pagination to get all products matching a request</a></li>
<li class="toctree-l3"><a class="reference internal" href="#get-facets-for-a-subset-of-the-pds-archive">Get facets for a subset of the PDS archive</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="responses.html">Responses</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials.html">Tutorials/Cookbooks</a></li>
<li class="toctree-l2"><a class="reference external" href="https://nasa-pds.github.io/pds-api/specifications/search-v1.1.0-redoc.html">API Full Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="links.html">Links</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../specifications.html">Specifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../general-conventions.html">General API Conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools.html">Tools and Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../support.html">Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../acknowlegements.html">Acknowledgements</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">PDS APIs</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../search.html">Search API User Guide</a></li>
      <li class="breadcrumb-item active">Query Syntax</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/nasa-pds/pds-api/blob/main/docs/source/guides/search/endpoints.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="query-syntax">
<h1>Query Syntax<a class="headerlink" href="#query-syntax" title="Link to this heading"></a></h1>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Since our servers are not fully populated with all PDS data sets, the examples presented in this user guide may return empty results or 404 (Not Found) errors. If there is a data set you would like added, please contact the <a class="reference external" href="mailto:pds-operator&#37;&#52;&#48;jpl&#46;nasa&#46;gov">PDS Help Desk</a> for assistance.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>curl command line tool is used to request the API in this documentation. curl is available in many operating systems by default. If not, you can get curl from <a class="reference external" href="https://curl.se/">https://curl.se/</a> or using a package management tool specific to your operating system (brew, apt, …).</p>
</div>
<section id="endpoints">
<h2>Endpoints<a class="headerlink" href="#endpoints" title="Link to this heading"></a></h2>
<p>The URLs for performing GET requests for searching PDS data are as follows.</p>
<p>The <strong>base URL</strong> of the PDS Search API, for search across all the PDS nodes, is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">pds</span><span class="o">.</span><span class="n">nasa</span><span class="o">.</span><span class="n">gov</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">search</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span>
</pre></div>
</div>
<p>The main use cases, to search, crawl products or resolve a product identifier are given in the following sections.</p>
</section>
<section id="search-products">
<h2>Search Products<a class="headerlink" href="#search-products" title="Link to this heading"></a></h2>
<section id="request-examples">
<h3>Request Examples<a class="headerlink" href="#request-examples" title="Link to this heading"></a></h3>
<p>Get the list of properties which describe the products, which criteria you can search against:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="w"> </span>curl<span class="w"> </span>-L<span class="w"> </span>--get<span class="w"> </span><span class="s1">&#39;https://pds.nasa.gov/api/search/1/properties&#39;</span>
</pre></div>
</div>
<p>Search for products which processing level is “Raw”, using the property “pds:Primary_Result_Summary.pds:processing_level” found before, get 10 results:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>-L<span class="w"> </span>--get<span class="w"> </span><span class="s1">&#39;https://pds.nasa.gov/api/search/1/products&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--data-urlencode<span class="w"> </span><span class="s1">&#39;limit=10&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--data-urlencode<span class="w"> </span><span class="s1">&#39;q=(pds:Primary_Result_Summary.pds:processing_level eq &quot;Raw&quot;)&#39;</span>
</pre></div>
</div>
</section>
<section id="request-template">
<h3>Request Template<a class="headerlink" href="#request-template" title="Link to this heading"></a></h3>
<p>The requests template is a follow:</p>
<div class="highlight-http notranslate"><div class="highlight"><pre><span></span><span class="nf">GET</span> <span class="nn">/api/search/1/classes/{product_class}[?[{query-parameter}={query-parameter-value}]*]</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="o">:</span> <span class="l">pds.nasa.gov</span>
</pre></div>
</div>
<p>The list of <cite>product_class</cite> proposed by the API can also be found from URL:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">pds</span><span class="o">.</span><span class="n">nasa</span><span class="o">.</span><span class="n">gov</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">search</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="n">classes</span>
</pre></div>
</div>
<p>The concept of product class is derived from the <a class="reference external" href="https://pds.nasa.gov/datastandards/documents/im/current/index_1I00.html">PDS4 standard</a>.</p>
</section>
<section id="query-detailed-syntax">
<h3>Query Detailed Syntax<a class="headerlink" href="#query-detailed-syntax" title="Link to this heading"></a></h3>
<section id="query-parameters">
<h4>Query Parameters<a class="headerlink" href="#query-parameters" title="Link to this heading"></a></h4>
<p>The query parameters are:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Query Parameter</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
<th class="head"><p><strong>Example</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>q</p></td>
<td><p>(Optional, string) Query string you wish to parse and use for search. See <a class="reference internal" href="#query-string-syntax">query string syntax</a></p></td>
<td><p>q=target_name eq “Mars”</p></td>
</tr>
<tr class="row-odd"><td><p>keywords</p></td>
<td><p>(Optional, string) String used for text search on title and description of the PDS4 labels</p></td>
<td><p>keyword=insight</p></td>
</tr>
<tr class="row-even"><td><p>fields</p></td>
<td><p>(Optional, array of strings) Array of fields you wish to return.</p></td>
<td><p>fields=pds:Time_Coordinates.pds:start_date_time</p></td>
</tr>
<tr class="row-odd"><td><p>sort</p></td>
<td><p>(Optional, array of strings) Array of fields you wish to sort by, mandatory when search-after is used</p></td>
<td><p>sort=ops:Harvest_Info.ops:harvest_date_time</p></td>
</tr>
<tr class="row-even"><td><p>search-after</p></td>
<td><p>(Optional, string or number) For pagination, the page will start from the value of the field selected in <cite>sort</cite>.</p></td>
<td><p>search-after=2024-01-23T22:53:30.402453Z</p></td>
</tr>
<tr class="row-odd"><td><p>limit</p></td>
<td><p>(Optional, integer, default=100) The number of records/results to return. By specifying a value of 0 only the summary of the results is returned, not the individual results.</p></td>
<td><p>limit=100</p></td>
</tr>
<tr class="row-even"><td><p>facet-fields</p></td>
<td><p>(Optional, array of strings) fields which are faceted: in summary, the count of the unique value used for the fields is given.</p></td>
<td><p>product_class,ops:Harvest_Info.ops:node_name</p></td>
</tr>
<tr class="row-odd"><td><p>facet-limit</p></td>
<td><p>(Optional, integer) maximum number of unique values counted for all faceted fields. Default is 10.</p></td>
<td><p>20</p></td>
</tr>
</tbody>
</table>
<p><cite>q</cite>, <cite>fields</cite> and <cite>facet-fields</cite> use PDS4 <a class="reference internal" href="#fields-dot-notation">Fields Dot Notation</a></p>
</section>
<section id="query-string-syntax">
<h4>Query String Syntax<a class="headerlink" href="#query-string-syntax" title="Link to this heading"></a></h4>
<p>An example of query syntax (<cite>q</cite> query parameter) is:</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">((</span><span class="n">pds</span><span class="p">:</span><span class="n">Primary_Result_Summary</span><span class="o">.</span><span class="n">pds</span><span class="p">:</span><span class="n">processing_level</span> <span class="n">eq</span> <span class="s2">&quot;Raw&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">ops</span><span class="p">:</span><span class="n">Data_File_Info</span><span class="o">.</span><span class="n">ops</span><span class="p">:</span><span class="n">file_size</span> <span class="n">ge</span> <span class="mi">8942</span><span class="p">))</span>
</pre></div>
</div>
<p>The query syntax follows the rules:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="n">query</span><span class="p">}</span> <span class="o">=</span> <span class="p">{</span><span class="n">comparison</span><span class="p">}</span><span class="o">|</span><span class="p">{</span><span class="n">group</span><span class="p">}</span>

<span class="p">{</span><span class="n">comparison</span><span class="p">}</span> <span class="o">=</span> <span class="p">{</span><span class="n">field</span><span class="p">}</span> <span class="p">{</span><span class="n">comparison</span> <span class="n">operator</span><span class="p">}</span> <span class="p">{</span><span class="n">literal</span> <span class="n">value</span><span class="p">}</span>

<span class="p">{</span><span class="n">group</span><span class="p">}</span> <span class="o">=</span> <span class="p">[</span><span class="ow">not</span><span class="p">]</span> <span class="p">({</span><span class="n">comparison</span><span class="p">}</span> <span class="p">[[</span><span class="ow">and</span><span class="o">|</span><span class="ow">or</span><span class="p">]</span> <span class="p">{</span><span class="n">group</span><span class="p">}])</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>{field}</strong> follows the <a class="reference internal" href="#fields-dot-notation">Fields Dot Notation</a> . The available fields can be found in responses <cite>summary</cite> object, <cite>properties</cite> attribute.</p></li>
<li><p><strong>{comparison operator}</strong> are eq, ne, gt, lt, ge, le</p></li>
<li><p><strong>{literal value}</strong> is either a string between <code class="docutils literal notranslate"><span class="pre">&quot;</span></code> (double quotes) or a numerical value (float or integer).</p></li>
<li><p>Wildcard searching is available with the <strong>like</strong> operator. The wildcarding syntax of the <strong>{literal value}</strong> follows the [OpenSearch Simple Query String](<a class="reference external" href="https://opensearch.org/docs/latest/opensearch/query-dsl/full-text/#simple-query-string">https://opensearch.org/docs/latest/opensearch/query-dsl/full-text/#simple-query-string</a>) convention.</p></li>
<li><p><strong>{group}</strong> has mandatory parentheses (round brackets) which make any complex query loaded with parentheses, as seen in the example above, don’t forget them !</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>the <code class="docutils literal notranslate"><span class="pre">like</span></code> operator does not work because of a known <a class="reference external" href="https://github.com/NASA-PDS/registry-api/issues/170">bug</a></p>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Operator</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
<th class="head"><p><strong>Example</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><em>Comparison Operators</em></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>eq</p></td>
<td><p>Equal</p></td>
<td><p>target_name <strong>eq</strong> “Mars”</p></td>
</tr>
<tr class="row-even"><td><p>like</p></td>
<td><p>Similar to</p></td>
<td><p>target_name <strong>like</strong> “mars”</p></td>
</tr>
<tr class="row-odd"><td><p>ne</p></td>
<td><p>Not equal</p></td>
<td><p>target_name <strong>ne</strong> “Saturn”</p></td>
</tr>
<tr class="row-even"><td><p>gt</p></td>
<td><p>Greater than</p></td>
<td><p>pds:Time_Coordinates.pds:start_date_time <strong>gt</strong> “2001-05-10T00:00:00Z”</p></td>
</tr>
<tr class="row-odd"><td><p>ge</p></td>
<td><p>Greater than or equal</p></td>
<td><p>pds:Time_Coordinates.pds:start_date_time <strong>ge</strong> “2001-05-10T00:00:00Z”</p></td>
</tr>
<tr class="row-even"><td><p>lt</p></td>
<td><p>Less than</p></td>
<td><p>pds:Time_Coordinates.pds:start_date_time <strong>lt</strong> “2020-06-01T00:00:00Z”</p></td>
</tr>
<tr class="row-odd"><td><p>le</p></td>
<td><p>Less than or equal</p></td>
<td><p>pds:Time_Coordinates.pds:start_date_time <strong>le</strong> “2020-06-01T00:00:00Z”</p></td>
</tr>
<tr class="row-even"><td><p><em>Logical Operators</em></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>and</p></td>
<td><p>Logical and</p></td>
<td><p>target_name <strong>eq</strong> “Mars” <strong>and</strong> instrument_name <strong>eq</strong> “hirise”</p></td>
</tr>
<tr class="row-even"><td><p>or</p></td>
<td><p>Logical or</p></td>
<td><p>target_name <strong>eq</strong> “Mars” <strong>or</strong> target_name <strong>eq</strong> “Phobos”</p></td>
</tr>
<tr class="row-odd"><td><p>not</p></td>
<td><p>Logical negation</p></td>
<td><p><strong>not</strong> target_name <strong>eq</strong> “Mars”</p></td>
</tr>
<tr class="row-even"><td><p><em>Grouping Operators</em></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>( )</p></td>
<td><p>Precedence grouping</p></td>
<td><p>((target_name <strong>eq</strong> “Mars” <strong>or</strong> target_name <strong>eq</strong> “Phobos”<strong>)</strong> <strong>and</strong> ( instrument_name <strong>eq</strong> “hirise” ))</p></td>
</tr>
</tbody>
</table>
</section>
<section id="fields-dot-notation">
<h4>Fields Dot Notation<a class="headerlink" href="#fields-dot-notation" title="Link to this heading"></a></h4>
<section id="general-case">
<h5>General Case<a class="headerlink" href="#general-case" title="Link to this heading"></a></h5>
<p>The syntax of the field names use a combination of the PDS4 Information Model and <a class="reference external" href="http://reeborg.ca/docs/oop_py_en/oop.html">dot
notation</a> representations of
an XML XPaths.</p>
<p>Query parameters will use a combination of an attribute with its parent
class in <em>all lowercase</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="n">namespace</span><span class="p">:</span><span class="n">parent_class</span><span class="p">}</span><span class="o">.</span><span class="p">{</span><span class="n">namespace</span><span class="p">:</span><span class="n">attribute</span><span class="p">}</span>
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pds</span><span class="p">:</span><span class="n">Science_Facets</span><span class="o">.</span><span class="n">pds</span><span class="p">:</span><span class="n">discipline_name</span>
<span class="n">pds</span><span class="p">:</span><span class="n">Investigation_Area</span><span class="o">.</span><span class="n">pds</span><span class="p">:</span><span class="nb">type</span>
</pre></div>
</div>
<p>The classes and attributes are defined in the <a class="reference external" href="https://pds.nasa.gov/datastandards/dictionaries/index-1.18.0.0.shtml">PDS4 Data Dictionnaries</a>.</p>
<p>The PDS4 data dictionaries are augmented with a specific  <a class="reference internal" href="responses.html#ops-namespace"><span class="std std-ref">ops Namespace</span></a> which contains attributes managed by the <a class="reference external" href="https://nasa-pds.github.io/registry/">PDS Registry</a> in addition to the PDS4 labels attributes.</p>
<p><span class="not-implemented">NOT IMPLEMENTED</span></p>
<p><span class="not-implemented">In the event that the {parent_class}.{attribute} combination does</span>
<span class="not-implemented">sufficiently guarantee uniqueness or sufficiency of search when a class</span>
<span class="not-implemented">is inherited by multiple classes, additional ancestor classes should be</span>
<span class="not-implemented">prepended to the query parameter until sufficient uniqueness is</span>
<span class="not-implemented">attained:</span></p>
<p><span class="not-implemented">{ns:ancestor_class}.{ns:parent_class}.{ns:attribute}</span></p>
<p><span class="not-implemented">If the query parameter grows beyond 3 ancestor classes, a :ref:custom</span>
<span class="not-implemented">query parameter &lt;Custom Query Parameters&gt; should be considered.</span></p>
<p><span class="not-implemented">In the event that multiple attributes are to be grouped together for</span>
<span class="not-implemented">search, the parent class should be used as the query parameter:</span></p>
<p><span class="not-implemented">{ancestor_class}.{parent_class}</span></p>
</section>
<section id="custom-query-parameters">
<h5>Custom Query Parameters<a class="headerlink" href="#custom-query-parameters" title="Link to this heading"></a></h5>
<p><span class="not-implemented">NOT IMPLEMENTED</span></p>
<p><span class="not-implemented">There are several cases where custom query parameters are preferred over</span>
<span class="not-implemented">the Dot Notation, but should only be avoided wherever possible in order</span>
<span class="not-implemented">to minimize confusion amongst developers attempting to use the API.</span>
<span class="not-implemented">These are also subject to approval by Search Integration Working Group</span>
<span class="not-implemented">representative for each node. That member is responsible for providing</span>
<span class="not-implemented">those updates to Engineering Node.</span></p>
<p><span class="not-implemented">Some reasons for custom query parameters:</span></p>
<p><span class="not-implemented">-   Combination of multiple attribute values into one</span></p>
<p><span class="not-implemented">-   Special cases where XQuery needs to be used for finding specific values (e.g. instrument/spacecraft described in Observing_System_Component class)</span></p>
<p><span class="not-implemented">-   Custom search fields on non-PDS4 metadata (e.g. image tags, operations note, etc.)</span></p>
<p><span class="not-implemented">-   Support common search or PDS4 terminology (e.g. target_name, lidvid)</span></p>
</section>
</section>
</section>
</section>
<section id="resolve-a-product-identifier">
<h2>Resolve A Product Identifier<a class="headerlink" href="#resolve-a-product-identifier" title="Link to this heading"></a></h2>
<section id="default-resolution">
<h3>Default Resolution<a class="headerlink" href="#default-resolution" title="Link to this heading"></a></h3>
<p>If you know the lid (for example <cite>urn:nasa:pds:insight_rad</cite>) or lidvid (for example <cite>urn:nasa:pds:insight_rad::2.1</cite>) identifier of a product, you can retrieve its description, whereever it is managed in the PDS system, with the following request:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>https://pds.nasa.gov/api/search/1/products/<span class="o">{</span>identifier<span class="o">}</span>
</pre></div>
</div>
<p>For example</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>--location<span class="w"> </span>--get<span class="w"> </span><span class="s1">&#39;https://pds.nasa.gov/api/search/1/products/urn:nasa:pds:insight_rad::2.1&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--header<span class="w"> </span><span class="s1">&#39;Accept: application/json&#39;</span>
</pre></div>
</div>
</section>
<section id="search-for-latest-vs-all-versions">
<h3>Search for Latest vs. All Versions<a class="headerlink" href="#search-for-latest-vs-all-versions" title="Link to this heading"></a></h3>
<section id="latest-version">
<h4>Latest Version<a class="headerlink" href="#latest-version" title="Link to this heading"></a></h4>
<p>By default, when the identifier is a lid (without a version, for example <a class="reference external" href="urn:nasa:pds:insight_rad">urn:nasa:pds:insight_rad</a>) only the latest description of the product is returned.</p>
<p>The request:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>https://pds.nasa.gov/api/search/1/products/<span class="o">{</span>lid<span class="o">}</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="crawl-a-data-set-hierarchy">
<h2>Crawl a Data Set Hierarchy<a class="headerlink" href="#crawl-a-data-set-hierarchy" title="Link to this heading"></a></h2>
<p>For a given product with identifier <cite>lidvid1</cite>, you can browse its parent products (member-of) or children (members).</p>
<section id="get-the-collections-of-a-bundle">
<h3>Get the Collections of a Bundle<a class="headerlink" href="#get-the-collections-of-a-bundle" title="Link to this heading"></a></h3>
<p>Get its <strong>children</strong> (collections):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">pds</span><span class="o">.</span><span class="n">nasa</span><span class="o">.</span><span class="n">gov</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">search</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="n">products</span><span class="o">/</span><span class="n">lidvid1</span><span class="o">/</span><span class="n">members</span>
</pre></div>
</div>
<p>For example, run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>--location<span class="w"> </span>--get<span class="w"> </span><span class="s1">&#39;https://pds.nasa.gov/api/search/1/products/urn:nasa:pds:insight_rad::2.1/members&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--header<span class="w"> </span><span class="s1">&#39;Accept: application/json&#39;</span>
</pre></div>
</div>
<p>The same request can be used to get the observational products or documents of a collection from the collection’s lidvid.</p>
</section>
<section id="get-the-observational-products-of-a-bundle">
<h3>Get the Observational Products of a Bundle<a class="headerlink" href="#get-the-observational-products-of-a-bundle" title="Link to this heading"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">pds</span><span class="o">.</span><span class="n">nasa</span><span class="o">.</span><span class="n">gov</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">search</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="n">products</span><span class="o">/</span><span class="n">lidvid1</span><span class="o">/</span><span class="n">members</span><span class="o">/</span><span class="n">members</span>
</pre></div>
</div>
<p>For example, run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>--location<span class="w"> </span>--get<span class="w"> </span><span class="s1">&#39;https://pds.nasa.gov/api/search/1/products/urn:nasa:pds:insight_rad::2.1/members/members&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--header<span class="w"> </span><span class="s1">&#39;Accept: application/json&#39;</span>
</pre></div>
</div>
</section>
<section id="get-the-collection-or-bundles-of-an-observational-product">
<h3>Get the Collection or Bundles of an Observational Product<a class="headerlink" href="#get-the-collection-or-bundles-of-an-observational-product" title="Link to this heading"></a></h3>
<p>Get its <strong>parent</strong> (collection):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">pds</span><span class="o">.</span><span class="n">nasa</span><span class="o">.</span><span class="n">gov</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">search</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="n">products</span><span class="o">/</span><span class="n">lidvid1</span><span class="o">/</span><span class="n">member</span><span class="o">-</span><span class="n">of</span>
</pre></div>
</div>
<p>The same request can be used to get the bundles of a collection from the collection’s lidvid.</p>
<p>Get its <strong>grandparent</strong> (bundle):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">pds</span><span class="o">.</span><span class="n">nasa</span><span class="o">.</span><span class="n">gov</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">search</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="n">products</span><span class="o">/</span><span class="n">lidvid1</span><span class="o">/</span><span class="n">member</span><span class="o">-</span><span class="n">of</span><span class="o">/</span><span class="n">member</span><span class="o">-</span><span class="n">of</span>
</pre></div>
</div>
<p>For example, run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>--location<span class="w"> </span>--get<span class="w"> </span><span class="s1">&#39;https://pds.nasa.gov/api/search/1/products/urn:nasa:pds:insight_rad:data_raw:hp3_rad_raw_00004_20181130_085325/member-of/member-of&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--header<span class="w"> </span><span class="s1">&#39;Accept: application/json&#39;</span>
</pre></div>
</div>
</section>
</section>
<section id="use-pagination-to-get-all-products-matching-a-request">
<h2>Use pagination to get all products matching a request<a class="headerlink" href="#use-pagination-to-get-all-products-matching-a-request" title="Link to this heading"></a></h2>
<p>When you’re searching for a large number of products, you’ll need to use pagination to ensure you receive all the results. Here’s how you can do it.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The pagination parameters (sort, limit, search-after) described in this section are applicable to all the end-points.</p>
</div>
<p>To start, let’s say you want to get all the members of a collection named “OSIRIS-REX Spectrometer calibrated observations”, which identifier is <em>urn:nasa:pds:orex.ovirs:data_calibrated::11.0</em>. You can use the following request in a web browser:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">pds</span><span class="o">.</span><span class="n">nasa</span><span class="o">.</span><span class="n">gov</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">search</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="n">products</span><span class="o">/</span><span class="n">urn</span><span class="p">:</span><span class="n">nasa</span><span class="p">:</span><span class="n">pds</span><span class="p">:</span><span class="n">orex</span><span class="o">.</span><span class="n">ovirs</span><span class="p">:</span><span class="n">data_calibrated</span><span class="p">::</span><span class="mf">11.0</span><span class="o">/</span><span class="n">members</span>
</pre></div>
</div>
<p>This request will only give you the first 100 products out of the total available in the collection (in this example, 334,940 products).</p>
<p>To get all the results, you need to use the pagination.</p>
<p><strong>1. Make the Initial Request:</strong></p>
<p>Sort the results by the harvest time, which is the time when products were loaded into the registry. You can do this using the <em>curl</em> command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>--location<span class="w"> </span>--get<span class="w"> </span><span class="s1">&#39;https://pds.nasa.gov/api/search/1/products/urn:nasa:pds:orex.ovirs:data_calibrated::11.0/members&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">   </span>--header<span class="w"> </span><span class="s1">&#39;Accept: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">   </span>--data-urlencode<span class="w"> </span><span class="s1">&#39;sort=ops:Harvest_Info.ops:harvest_date_time&#39;</span>
</pre></div>
</div>
<p>You are getting the first 100 products, members of the collection, sorted by harvest time (time when they were loaded in the registry).</p>
<p><strong>2. Get the Next Page</strong></p>
<p>To retrieve the next set of results, you need to get the latest harvest date and time from the previous response. This information is included in the description of the last product returned.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;ops:Harvest_Info.ops:harvest_date_time&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">   </span><span class="s2">&quot;2023-05-26T05:53:24.611495Z&quot;</span>
<span class="p">],</span>
</pre></div>
</div>
<p>Use this latest harvest date and time as the reference for the next request:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>--location<span class="w"> </span>--get<span class="w"> </span><span class="s1">&#39;https://pds.nasa.gov/api/search/1/products/urn:nasa:pds:orex.ovirs:data_calibrated::11.0/members&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">   </span>--header<span class="w"> </span><span class="s1">&#39;Accept: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">   </span>--data-urlencode<span class="w"> </span><span class="s1">&#39;sort=ops:Harvest_Info.ops:harvest_date_time&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">   </span>--data-urlencode<span class="w"> </span><span class="s1">&#39;search-after=2023-05-26T05:53:24.611495Z&#39;</span>
</pre></div>
</div>
<p><strong>3. Iterate Until Completion:</strong></p>
<p>Keep making requests and updating the <em>search-after</em> parameter with the latest harvest date and time until the number of products returned is less than the limit (100 in this case).</p>
<p><strong>4. Changing Pagination Parameters:</strong></p>
<p>You can adjust the default limit of 100 products per page using the limit parameter. For example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>--location<span class="w"> </span>--get<span class="w"> </span><span class="s1">&#39;https://pds.nasa.gov/api/search/1/products/urn:nasa:pds:orex.ovirs:data_calibrated::11.0/members&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">   </span>--header<span class="w"> </span><span class="s1">&#39;Accept: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">   </span>--data-urlencode<span class="w"> </span><span class="s1">&#39;limit=500&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">   </span>--data-urlencode<span class="w"> </span><span class="s1">&#39;sort=ops:Harvest_Info.ops:harvest_date_time&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">   </span>--data-urlencode<span class="w"> </span><span class="s1">&#39;search-after=2023-05-26T05:53:24.611495Z&#39;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The number of products per page, specified by the limit parameter should be below a few 1000s. If the queries are too demanding for the server, you might experience <a class="reference external" href="https://github.com/NASA-PDS/registry-api/discussions/521">504 errors</a> . The optimal number of product per page for quicker data retrieval depends on the type of response requested, as shown in statistics on <a class="reference external" href="https://github.com/NASA-PDS/registry-api/issues/552#issuecomment-2389199054">pagination performances</a>.</p>
</div>
</section>
<section id="get-facets-for-a-subset-of-the-pds-archive">
<h2>Get facets for a subset of the PDS archive<a class="headerlink" href="#get-facets-for-a-subset-of-the-pds-archive" title="Link to this heading"></a></h2>
<p>Faceted search gives you an overview of the results returned by a query. For specified fields, the API response includes a list of the values found in the result set, along with the number of products associated with each value. These are called <em>facets</em>.</p>
<p>You can facet on multiple fields.</p>
<p>By default, the API returns the top 10 values (i.e., the most frequently occurring) for each faceted field. This default can be overridden using the <cite>facet-limit</cite> parameter.</p>
<p>The following example retrieves the 100 most referenced investigation and target LIDVIDs across the entire archive:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>--location<span class="w"> </span>--get<span class="w"> </span><span class="s1">&#39;https://pds.nasa.gov/api/search/1/products&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">   </span>--header<span class="w"> </span><span class="s1">&#39;Accept: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">   </span>--data-urlencode<span class="w"> </span><span class="s1">&#39;limit=0&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">   </span>--data-urlencode<span class="w"> </span><span class="s1">&#39;facet-fields=ref_lid_investigation,ref_lid_target&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">   </span>--data-urlencode<span class="w"> </span><span class="s1">&#39;facet-limit=100&#39;</span>
</pre></div>
</div>
<p>You can also apply faceted search to a subset of the PDS archive. The following example lists the most frequently referenced targets associated with the <em>Ultraviolet Imaging Spectrograph</em> instrument on the <em>Cassini Orbiter</em>, using its LID <cite>urn:nasa:pds:context:instrument:uvis.co</cite>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>--location<span class="w"> </span>--get<span class="w"> </span><span class="s1">&#39;https://pds.nasa.gov/api/search/1/products&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">   </span>--header<span class="w"> </span><span class="s1">&#39;Accept: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">   </span>--data-urlencode<span class="w"> </span><span class="s1">&#39;limit=0&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">   </span>--data-urlencode<span class="w"> </span><span class="s1">&#39;q=ref_lid_instrument eq &quot;urn:nasa:pds:context:instrument:uvis.co&quot;&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">   </span>--data-urlencode<span class="w"> </span><span class="s1">&#39;facet-fields=ref_lid_target&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">   </span>--data-urlencode<span class="w"> </span><span class="s1">&#39;facet-limit=100&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">   </span>--data-urlencode<span class="w"> </span><span class="s1">&#39;limit=0&#39;</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="quickstart.html" class="btn btn-neutral float-left" title="Quickstart" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="responses.html" class="btn btn-neutral float-right" title="Responses" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022 California Institute of Technology.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>